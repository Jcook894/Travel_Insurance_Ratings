(function(){!function(t){"use strict";var e;return e=function(){function e(e,i){this.filter={},this.$input=t(e).hide(),this.$container={},this.$form=this.$input.closest("form"),this.$wrapper=this.$input.closest(".jr-filter-wrap"),this.fieldName=this.$input.data("fieldName"),this.filterType="",this.$label=this.$wrapper.find(".jr-filter-label"),this.$selectedFilterPreview=t('<p class="jr-selected-filters-preview jrSelectedFiltersPreview">').appendTo(this.$label),this.$applyLink=t('<a href="javascript:;" class="jr-apply-filter jrApplyFilter jrButton jrSmall jrIconOnly"><span class="jrIconApplyFilter"></span></a>'),this.$filterClear=t('<div class="jr-filter-reset jrHidden"><a href="javascript:;" class="jr-filter-clear jrClearFilter">'+jreviews.__t("FILTERS_CLEAR_SELECTED")+"</a></div>"),this.$showAll=t('<a href="javascript:;" class="jrFilterShowAll jrHidden">'+jreviews.__t("FILTERS_SHOW_ALL")+"</a>"),this.$showLess=t('<a href="javascript:;" class="jrFilterShowLess jrHidden">'+jreviews.__t("FILTERS_SHOW_LESS")+"</a>"),this.displayAs=this.$input.data("display-as"),this.options=this.getOptions(i),this.init()}var i;return i={split_option_limit:10,link_css:{item:"jrLink"},linkboxed_css:{item:"jrLinkBoxed"}},e.prototype.init=function(){var e=this;e.$filter=this.loadFilter(),e.$container=e.$filter.transform();var i=t("<span>").hide();i.appendTo(e.$wrapper),e.$container=e.$container.insertAfter(i),e.updateSelectedOptionsPreview(),e.addFilterClear(),e.addShowAll(),e.$input.data("isControlled")===!1&&e.$wrapper.show(),e.$input.on("change",function(i){e.resetListingTypeInputs(t(i.target))}),e.$label.length>0&&0==e.$label.hasClass("jr-no-slideout")?e.$label.on("click",function(){e.$container.slideToggle(),e.$wrapper.toggleClass("jrIsOpen",0==e.$wrapper.hasClass("jrIsOpen"))}):e.$container.show(),e.$input.on("updateFilter",function(){e.updateSelectedOptionsPreview(),e.contextAwarenessCheck(),e.$input.trigger("change")}),e.$input.on("updateFilterNoChange",function(){e.updateSelectedOptionsPreview(),e.contextAwarenessCheck()}),1==e.$wrapper.data("autoOpen")&&e.$label.trigger("click"),e.contextAwarenessCheck()},e.prototype.updateSelectedOptionsPreview=function(){var e=[],i=0==this.$input.data("preview")?0:1;1==i&&(this.$input.children("option:selected").each(function(){""!==t(this).val()&&null!==t(this).val()&&e.push(t(this).text())}),this.$selectedFilterPreview.html(e.join(", ")))},e.prototype.contextAwarenessCheck=function(){if(t.inArray(this.filterType,["checkbox","select","link","linkboxed"])>-1){var e=this.$input.children("option");if(0===e.length)return void this.$wrapper.addClass("jrHidden");if(1===e.length)return void(""==e.attr("value")&&this.$wrapper.addClass("jrHidden"));this.$wrapper.removeClass("jrHidden")}},e.prototype.resetListingTypeInputs=function(t){var e=t.children("option:selected").eq(0);(""==e.val()||void 0!==e.data("listingType")&&e.data("listingType")!=t.data("oldListingType"))&&this.$form.find('[name^="data[Field]"],[name="data[usematch]"]').val("")},e.prototype.getFieldQuerySwitch=function(){var e,i=this;return 1==i.$input.data("matchSwitch")?(e=t('<div class="jrToggleSwitchRow"><div class="jrToggleLabel">'+jreviews.__t("FILTERS_MATCH_ALL")+'</div><div class="jrToggleSwitch"><input id="toggle-'+i.fieldName+'" class="jrToggle jrToggleRound" type="checkbox" name="data[matchall]['+i.fieldName+']" value="1" '+(1==i.$input.data("match-all")?"checked":"")+'><label for="toggle-'+i.fieldName+'"></label></div></div>'),e.on("click",function(){var e=t(this).find("input");e.prop("checked",!e.prop("checked")).trigger("change")}),e.on("change","input",function(t){t.stopPropagation(),null!==i.$input.val()&&i.$input.val().length>1&&setTimeout(function(){i.$input.trigger("change")},500)})):1==i.$input.data("match-all")&&(e=t('<input type="hidden" name="data[matchall]['+i.fieldName+']" value="1" />')),e},e.prototype.getOptions=function(e){var r={split_option_limit:this.$input.data("splitOptionLimit")};return t.extend({},i,e,r)},e.prototype.getContainer=function(e){var i=t('<div class="jr-filter-container jrFilterContainer '+e+'"><div class="jr-filter-selected jrFilterSelected jrHidden"></div><div class="jr-filter-unselected jrFilterUnselected"></div></div>');return i.hide(),i},e.prototype.getContainerText=function(e){var i=t('<div class="jr-filter-container jrFilterContainer '+e+'">');return i.hide(),i},e.prototype.addFilterClear=function(){var t=this;1==t.$input.data("reset")&&"function"==typeof t.$filter.clear&&(t.$container.prepend(t.$filterClear),t.$filterClear.on("click",".jr-filter-clear",function(){t.$filter.clear(),t.$input.trigger("updateFilter")}))},e.prototype.addShowAll=function(){var e=this,i=e.$input.data("showLimit")||5,r=e.$container.find(".jr-filter-unselected .jr-filter-item");e.$filter.allowShowAll&&1==e.$input.data("showAll")&&r.length>i&&(e.$container.append(e.$showAll.removeClass("jrHidden"),e.$showLess),e.$showAll.on("click",function(i){i.preventDefault(),t(this).hide(),e.$showLess.removeClass("jrHidden").show(),r.show()}),e.$showLess.on("click",function(r){r.preventDefault(),t(this).hide(),e.$container.find(".jr-filter-unselected .jr-filter-item:gt("+(i-1)+")").hide(),e.$showAll.show(),jreviews.mobi||e.$container.jrScrollTo({duration:350,offset:-100})}).trigger("click"))},e.prototype.getApplyLink=function(){return this.$applyLink},e.prototype.loadFilter=function(){var t;switch(this.displayAs){case"linkboxed":t="link";break;default:t=this.displayAs}return this.filterType=t,new this.filters[t](this)},e.prototype.filters={},e.prototype.reset=function(){var t=this;this.$filter.clear(),this.updateSelectedOptionsPreview(),this.$filter.updateFilter(this.$container),t.$input.data("isControlled")===!0&&(t.$wrapper.toggleClass("jrIsOpen",!1),t.$wrapper.hide(),t.$wrapper.find(".jr-filter-container").hide())},e.prototype.submit=function(){this.$input.trigger("change")},e.prototype.filters.checkbox=function(t){this.$transformer=t,this.$input=t.$input,this.splitList=t.$input.data("splitList"),this.allowShowAll=!0},e.prototype.filters.checkbox.prototype={constructor:e.prototype.filters.checkbox,transform:function(){var e,i=this;return e=this.$transformer.getContainer("jrCheckboxFilter"),e.prepend(i.$transformer.getFieldQuerySwitch()),i.init(e),i.watch(e),e.on("click",".jr-filter-item",function(){{var e,r=t(this);r.find("span")}e=i.$transformer.$input.children('[value="'+r.data("value")+'"]'),e.prop("selected",e.is(":selected")?!1:!0),i.$transformer.$input.trigger("updateFilter")})},init:function(t){var e=this;e.setup(t),e.$input.on("updateFilter",function(){e.updateFilter(t)}).trigger("updateFilter"),e.$input.on("updateFilterNoChange",function(){e.updateFilter(t)})},setup:function(e){var i=this,r=e.find(".jr-filter-unselected").html("");e.find(".jr-filter-selected").find(".jr-filter-item").remove(),i.optionCount=i.$input.children("option").length,i.$input.children("option").each(function(){var e,i;e=t(this),""!=e.val()&&(i=t('<a href="javascript:;" class="jr-filter-item jrFilterItem" data-value="'+e.val()+'"><span></span>'+e.text()+"</a>"),r.append(i))})},watch:function(t){var e=this;e.$input.data("isControlled")&&setInterval(function(){e.$input.children("option").length!==e.optionCount&&(e.setup(t),e.updateFilter(t))},100)},clear:function(){var t=this;t.$input.val("")},updateFilter:function(e){var i,r,n,a,l=this,s=l.$transformer.options.split_option_limit;n=this.$transformer.$input,a=n.children("option").length,i=e.find(".jr-filter-selected"),r=e.find(".jr-filter-unselected"),n.children("option").each(function(){var e=t(this),n=r.find('a[data-value="'+e.val()+'"]'),o=i.find('a[data-value="'+e.val()+'"]');""!=e.val()&&(e.is(":selected")?(n.find("span").removeClass("jrIconUnchecked").addClass("jrIconChecked"),a>s&&l.splitList&&(n.after(t('<span class="jrHidden" data-value="'+e.val()+'">')).detach(),i.append(n))):(o.find("span").removeClass("jrIconChecked").addClass("jrIconUnchecked"),n.find("span").removeClass("jrIconChecked").addClass("jrIconUnchecked"),a>s&&o&&l.splitList&&(o.detach(),r.find('span[data-value="'+e.val()+'"]').replaceWith(o))))}),i.toggleClass("jrHidden",""==i.html()),l.$transformer.$filterClear.toggleClass("jrHidden",""==i.html())}},e.prototype.filters.link=function(t){this.options=t.options,this.$transformer=t,this.$input=t.$input,this.splitList=t.$input.data("splitList"),this.css=t.options[t.displayAs+"_css"],this.allowShowAll="linkboxed"!==t.displayAs?!0:!1},e.prototype.filters.link.prototype={constructor:e.prototype.filters.link,transform:function(){var e,i=this;return e=this.$transformer.getContainer("linkboxed"==i.$transformer.displayAs?"jrLinkBoxedFilter":"jrLinkFilter"),"link"==i.$transformer.displayAs&&e.prepend(i.$transformer.getFieldQuerySwitch()),i.init(e),i.watch(e),e.on("click",".jr-filter-item",function(){var e;return 0==i.$input.data("deselect")&&i.$input.val()==t(this).data("value")?!1:(i.$input.data("oldListingType",i.$input.children("option:selected").data("listingType")),e=i.$input.children('[value="'+t(this).data("value")+'"]'),e.prop("selected")?(e.prop("selected",!1),i.$input.prop("multiple")||i.$input.val("")):e.prop("selected",!0),void i.$input.trigger("updateFilter"))})},init:function(e){var i=this,r=e.find(".jr-filter-unselected").html("");e.find(".jr-filter-selected").find(".jr-filter-item").remove(),i.optionCount=i.$input.children("option").length,i.$input.children("option").each(function(){var e,n;e=t(this),""!=e.val()&&(n=t('<a href="javascript:;" class="jr-filter-item jrFilterItem '+i.css.item+'" data-value="'+e.val()+'">'+e.text()+"</a>"),r.append(n))}),i.$input.on("updateFilter",function(){i.updateFilter(e)}).trigger("updateFilter"),i.$input.on("updateFilterNoChange",function(){i.updateFilter(e)})},watch:function(t){var e=this;e.$input.data("isControlled")&&setInterval(function(){e.$input.children("option").length!==e.optionCount&&e.init(t)},100)},clear:function(){var t=this;t.$input.val("")},updateFilter:function(e){var i,r,n,a=this,l=a.$transformer.options.split_option_limit;n=this.$input.children("option").length,i=e.find(".jr-filter-selected"),r=e.find(".jr-filter-unselected"),this.$input.children("option").each(function(){var e=t(this),s=r.find('a[data-value="'+e.val()+'"]').removeClass("jrChecked"),o=i.find('a[data-value="'+e.val()+'"]');""!=e.val()&&(e.prop("selected")?(s.addClass("jrChecked"),n>l&&a.splitList&&s.after(t('<span class="jrHidden" data-value="'+e.val()+'">')).appendTo(i)):n>l&&o&&a.splitList&&(o.detach(),r.find('span[data-value="'+e.val()+'"]').replaceWith(o.removeClass("jrChecked"))))}),i.toggleClass("jrHidden",""==i.html()),a.$transformer.$filterClear.toggleClass("jrHidden",null==a.$input.val())}},e.prototype.filters.select=function(t){this.options=t.options,this.$transformer=t,this.$input=t.$input,this.allowShowAll=!1},e.prototype.filters.select.prototype={constructor:e.prototype.filters.select,transform:function(){var t,e=this;t=this.$transformer.getContainerText("jrSelectFilter");var i=e.$transformer.$input.prop("multiple",!1).removeClass("jrSelectMultiple").addClass("jrSelect").detach();return t.append(i.show()),e.$input.on("updateFilter",function(){e.updateFilter(t)}).trigger("updateFilter"),e.$input.on("updateFilterNoChange",function(){e.updateFilter(t)}),e.$input.on("change",function(){e.$input.trigger("updateFilterNoChange")}),t},clear:function(){this.$input.val("")},updateFilter:function(){this.$transformer.$filterClear.toggleClass("jrHidden",""==this.$input.val())}},e.prototype.filters.text=function(t){this.options=t.options,this.$transformer=t,this.$input=t.$input,this.allowShowAll=!1},e.prototype.filters.text.prototype={constructor:e.prototype.filters.text,transform:function(){var t,e=this;t=this.$transformer.getContainerText("jrTextFilter");var i=e.$input.on("change",function(t){void 0!==t.originalEvent&&t.stopPropagation()}).detach();return t.append(i.addClass("jrText").css("display","inline-block")),e.$transformer.getApplyLink().appendTo(t),i.on("keydown",function(e){13==e.keyCode&&(e.preventDefault(),t.find(".jr-apply-filter").trigger("click"))}),e.$input.on("updateFilter",function(){e.updateFilter(t)}).trigger("updateFilter"),e.$input.on("updateFilterNoChange",function(){e.updateFilter(t)}),t.on("click",".jr-apply-filter",function(){e.$input.trigger("updateFilter")})},clear:function(){var t=this;t.$input.val("")},updateFilter:function(){this.$transformer.$filterClear.toggleClass("jrHidden",""==this.$input.val())}},e.prototype.filters.autosuggest=function(t){this.options=t.options,this.$transformer=t,this.$input=t.$input,this.$autosuggest=t.$wrapper.find(".ui-autocomplete-input").addClass("jrText jrClear").detach(),this.allowShowAll=!1},e.prototype.filters.autosuggest.prototype={constructor:e.prototype.filters.text,transform:function(){var e,i=this;e=this.$transformer.getContainerText("jrTextFilter"),this.$container=e;{var r=i.$transformer.$input.detach(),n=i.$transformer.$wrapper.find(".ui-helper-hidden-accessible").detach();i.$transformer.$wrapper.find(".ui-optionsDiv").detach()}return i.optionCount=i.$input.children("option").length,e.append(r,i.$autosuggest,n),i.init(e),i.watch(e),i.$input.on("updateFilter",function(){i.updateFilter(e)}).trigger("updateFilter"),i.$input.on("updateFilterNoChange",function(){i.updateFilter(e)}),i.$input.on("autoCompleteSelect",function(){i.updateFilter(e),i.$transformer.updateSelectedOptionsPreview(),i.$autosuggest.val("")}),e.on("click",".jr-filter-item",function(){var e,r=t(this);e=i.$transformer.$input.children('[value="'+r.data("value")+'"]'),e.prop("selected",e.is(":selected")?!1:!0),i.$input.trigger("updateFilter")})},init:function(t){{var e=this;t.find(".jr-filter-unselected").html("")}t.find(".jr-filter-item").remove(),e.optionCount=e.$input.children("option").length,this.updateCheckboxes(),e.$input.trigger("updateFilter")},updateCheckboxes:function(){var e=this;this.$input.children("option").each(function(){var i,r;if(i=t(this),""!=i.val()){if(r=e.$container.find('.jr-filter-item[data-value="'+i.val()+'"]'),r.length)i.is(":selected")?r.find("span").switchClass("jrIconUnchecked","jrIconChecked"):r.find("span").switchClass("jrIconChecked","jrIconUnchecked");else{var n=i.is(":selected")?"jrIconChecked":"jrIconUnchecked";r=t('<a href="javascript:;" class="jr-filter-item jrFilterItem" data-value="'+i.val()+'"><span class="'+n+'"></span>'+i.text()+"</a>"),e.$container.append(r)}i.is(":selected")?r.css("display","block"):r.hide()}})},watch:function(t){var e=this;setInterval(function(){e.$input.children("option").length!==e.optionCount&&e.init(t)},100)},clear:function(){this.$input.val("").children("option").remove(),this.$container.find(".jr-filter-item").remove()},updateFilter:function(){var t=this;t.$transformer.$filterClear.toggleClass("jrHidden",""==t.$input.val()||null==t.$input.val()),t.$autosuggest.val(""),this.updateCheckboxes()}},e.prototype.filters.geosearch=function(t){this.options=t.options,this.$transformer=t,this.$input=t.$input,this.$radius=this.$transformer.$wrapper.find('[name="data[Field][Listing][jr_radius]"]'),this.allowShowAll=!1},e.prototype.filters.geosearch.prototype={constructor:e.prototype.filters.geosearch,transform:function(){var e,i=this,r=t();e=this.$transformer.getContainerText("jrGeosearchFilter");var n=i.$input.closest(".jrInputButtonRow"),a=i.$input.show().on("change",function(t){void 0!==t.originalEvent&&t.stopPropagation()}),l=n.length>0?n.detach():a.detach();if(i.$radius.length){var s=t('<div class="jrSliderInputValue">');t.ui.slider.prototype.widgetEventPrefix="slider",r=t('<div class="jrSliderInput">').after(s).slider({min:i.$radius.data("min"),max:i.$radius.data("max"),step:i.$radius.data("step"),value:i.$radius.val(),slide:function(t,e){i.$radius.val(e.value),s.html(i.radiusString())}}),i.$radius.on("change",function(){r.slider("value",t(this).val())}),s.html(i.radiusString())}return i.$transformer.getApplyLink().appendTo(e),e.append(l,r,s),i.$input.on("updateFilter",function(){i.updateFilter(e)}).trigger("updateFilter"),i.$input.on("updateFilterNoChange",function(){i.updateFilter(e)}),e.on("click",".jr-apply-filter",function(){i.$input.trigger("updateFilter")})},radiusString:function(){return this.$radius.val()+' <span class="jrRadiusMetric">'+this.$radius.data("metric")+"</span>"},clear:function(){var t=this;t.$input.val("").trigger("keyup")},updateFilter:function(){this.$transformer.$filterClear.toggleClass("jrHidden",""==this.$input.val())}},e.prototype.filters.numberrange=function(t){this.options=t.options,this.$transformer=t,this.$container=null,this.$input=t.$input,this.$lowrange=t.$input.hide(),this.$highrange=this.$lowrange.next("span").hide().children("input"),this.$operator=this.$lowrange.prev("select").val("between").hide(),this.allowShowAll=!1},e.prototype.filters.numberrange.prototype={constructor:e.prototype.filters.numberrange,transform:function(){var e,i,r,n=this;e=this.$transformer.getContainer("jrRangeFilter"),i='<div class="jrRangeFilterInner">',i+='<label class="jrRangeFilterLabel">'+jreviews.__t("FILTERS_RANGE_MIN")+'</label><input class="jrRangeInput" type="text" placeholder="0">',i+='<span class="jrRangeDelimiter">'+jreviews.__t("FILTERS_RANGE_DELIMITER")+"</span>",i+='<label class="jrRangeFilterLabel">'+jreviews.__t("FILTERS_RANGE_MAX")+'</label><input class="jrRangeInput" type="text" placeholder="100">',i+="</div>";var a=t(i);return n.$transformer.getApplyLink().appendTo(a),e.html(a),e.on("change","input",function(t){t.stopPropagation()}),r=e.find("input"),""!=this.$lowrange.val()&&r.eq(0).val(this.$lowrange.val()),""!=this.$highrange.val()&&r.eq(1).val(this.$highrange.val()),n.$container=e,n.$input.on("updateFilter",function(){n.updateFilter()}).trigger("updateFilter"),n.$input.on("updateFilterNoChange",function(){n.updateFilter(e)}),e.on("click",".jr-apply-filter",function(){var t;t=e.find("input"),n.$lowrange.val(t.eq(0).val()),n.$highrange.val(t.eq(1).val()),n.$lowrange.trigger("updateFilter")})},clear:function(){var t=this;t.$lowrange.val(""),t.$highrange.val(""),t.$container.find("input").val("")},updateFilter:function(){var t=this;this.$transformer.$filterClear.toggleClass("jrHidden",""==t.$lowrange.val()&&""==t.$highrange.val())}},e.prototype.filters.daterange=function(t){this.options=t.options,this.$transformer=t,this.$input=t.$input,this.$lowrange=t.$input.hide(),this.$highrange=this.$lowrange.next("img").hide().next("span").hide().children("input"),this.$operator=t.$input.prev("select").val("between").hide(),this.allowShowAll=!1},e.prototype.filters.daterange.prototype={constructor:e.prototype.filters.daterange,transform:function(){var e,i,r,n=this;e=this.$transformer.getContainer("jrRangeFilter"),i='<div class="jrRangeFilterInner">',i='<input class="jr-date jrDate jrRangeInput" type="text" placeholder="">',i+='<span class="jrRangeDelimiter">'+jreviews.__t("FILTERS_RANGE_DELIMITER")+"</span>",i+='<input class="jr-date jrDate jrRangeInput" type="text" placeholder="">',i+="</div>";var a=t(i);return n.$transformer.getApplyLink().appendTo(a),e.html(a),e.on("change","input",function(t){t.stopPropagation()}),r=e.find("input"),""!=this.$lowrange.val()&&r.eq(0).val(this.$lowrange.val()),""!=this.$highrange.val()&&r.eq(1).val(this.$highrange.val()),n.$container=e,n.$input.on("updateFilter",function(){n.updateFilter()}).trigger("updateFilter"),n.$input.on("updateFilterNoChange",function(){n.updateFilter(e)}),e.on("click",".jr-apply-filter",function(){var t;t=e.find("input"),n.$lowrange.val(t.eq(0).val()),n.$highrange.val(t.eq(1).val()),n.$lowrange.trigger("updateFilter")})},clear:function(){var t=this;t.$lowrange.val(""),t.$highrange.val(""),t.$container.find("input").val("")},updateFilter:function(){var t=this;this.$transformer.$filterClear.toggleClass("jrHidden",""==t.$lowrange.val()&&""==t.$highrange.val())}},e.prototype.filters.rating=function(t){this.$transformer=t,this.$input=t.$input,this.allowShowAll=!1},e.prototype.filters.rating.prototype={constructor:e.prototype.filters.rating,transform:function(){var e,i=this;return e=this.$transformer.getContainerText("jrRatingFilter"),this.$input.children("option").each(function(){var r,n;if(r=t(this),""!=r.val()){var a=r.val()/5*100+"%";n=t('<a href="javascript:;" class="jr-filter-item jrFilterItem jrRatingStar" data-value="'+r.val()+'">'+sprintf(jreviews.__t("FILTERS_RATINGS_AND_UP"),'<div class="'+i.$input.data("class")+'"><div style="width:'+a+'"></div></div>')+"</a>"),e.append(n)}}),this.$input.on("updateFilter",function(){i.updateFilter(e)}).trigger("updateFilter"),i.$input.on("updateFilterNoChange",function(){i.updateFilter(e)}),e.on("click",".jr-filter-item",function(){var e;e=i.$input.children('[value="'+t(this).data("value")+'"]'),e.prop("selected")?i.$input.val(""):e.prop("selected",!0),i.$input.trigger("updateFilter")})},clear:function(){var t=this;t.$input.val("")},updateFilter:function(e){this.$input.children("option").each(function(){var i,r;i=t(this),r=e.find('.jr-filter-item[data-value="'+i.val()+'"]'),r.toggleClass("jrChecked",i.is(":selected"))}),this.$transformer.$filterClear.toggleClass("jrHidden",""==this.$input.val())}},e}(),jQuery.fn.jrFilterTransformer=function(i){var r=arguments;if(void 0===i||"object"==typeof i)return this.each(function(){t.data(this,"plugin_jrFilterTransformer")||t.data(this,"plugin_jrFilterTransformer",new e(this,i))});if("string"==typeof i&&"_"!==i[0]&&"init"!==i){var n;return this.each(function(){var a=t.data(this,"plugin_jrFilterTransformer");a instanceof e&&"function"==typeof a[i]&&(n=a[i].apply(a,Array.prototype.slice.call(r,1))),"destroy"===i&&t.data(this,"plugin_jrFilterTransformer",null)}),void 0!==n?n:this}}}(jQuery),function(t){"use strict";var e;return e=function(){function e(e,i){var r=this;this.$module=t(e),this.options=this.getOptions(i);var n='<div class="jrFiltersPanel"><div class="jrFiltersPanelHead"><h3 class="jrFilterPanelTitle"></h3><a href="#" class="jr-filters-panel-close jrFiltersPanelclose" onclick="javascript:;"><span class="jrIconClose"></span></a></div><div class="jr-filters-panel-scrollable jrFiltersPanelScrollable"></div></div><div class="jr-filters-panel-overlay jrFiltersPanelOverlay"></div>';this.$moduleContainer=this.options.container_class?this.$module.closest("."+this.options.container_class):[],this.$panel=t(n).hide(),this.$overlay=this.$panel.find(".jr-filters-panel-overlay"),this.$modulePlaceholder=t('<span class="jr-module-placeholder">').css("visibility","hidden"),this.$filtersPlaceholder=t('<span class="jr-filters-placeholder">').hide(),1===this.$module.length&&this.$moduleContainer.length&&(this.init(),t(document).on("jreviews-onAfterAjaxUpdate",function(){r.refresh()}))}var i;return i={resizeDelay:250,container_class:"mod-container",title_class:"mod-title",desktop_width:992},e.prototype.init=function(){this.$modulePlaceholder.insertBefore(this.$moduleContainer),this.bindCloseEvents(),this.bindFiltersButton(),this.$filtersPlaceholder.insertBefore(this.$module),this.moduleOffsetTop=this.$modulePlaceholder.offset().top,this.options.title_class&&this.$panel.find("h3").html(this.$moduleContainer.find("."+this.options.title_class).text()),this.bindResizeEvent()},e.prototype.refresh=function(){this.bindFiltersButton(),this.desktopView()?(this.$moduleContainer.hide(),this.displayMobileFilters()):(this.$moduleContainer.show(),this.displayDesktopFilters())},e.prototype.bindCloseEvents=function(){var e=this;this.$panel.on("click",".jr-filters-panel-close",function(i){i.preventDefault(),e.$panel.hide(),t("html").removeClass("jrFiltersNoScroll")}).on("click",function(i){i.preventDefault(),i.stopPropagation(),t(this).hasClass("jr-filters-panel-overlay")&&(e.$panel.hide(),t("html").removeClass("jrFiltersNoScroll"))}).appendTo(t("body"))},e.prototype.bindFiltersButton=function(){var e=this;this.$toggleButton=t(".jr-list-show-filters"),this.$toggleButton.on("click",function(i){i.preventDefault(),e.$panel.toggle(),t("html").toggleClass("jrFiltersNoScroll",e.$panel.is(":visible"))})},e.prototype.desktopView=function(){return t("body").width()<this.options.desktop_width||0==this.options.desktop_width},e.prototype.bindResizeEvent=function(){function e(){new Date-i<a?setTimeout(e,a):(n=!1,r.desktopView()?(r.$moduleContainer.hide(),r.displayMobileFilters()):(r.$moduleContainer.show(),r.displayDesktopFilters()))}var i,r=this,n=!1,a=this.options.resizeDelay;0===jreviews.mobi&&t(window).resize(function(){i=new Date,n===!1&&(n=!0,setTimeout(e,a))}),e()},e.prototype.displayMobileFilters=function(){t.contains(this.$panel,this.$module)===!1&&this.$module.appendTo(this.$panel.find(".jr-filters-panel-scrollable")),this.$toggleButton.show()},e.prototype.displayDesktopFilters=function(){t("html").removeClass("jrFiltersNoScroll"),this.$panel.hide(),this.$toggleButton.hide(),this.$filtersPlaceholder.after(this.$module)},e.prototype.getOptions=function(e){return t.extend({},i,this.$module.find("form").data("options")||{},e)},e}(),jQuery.fn.jrFiltersPanel=function(t){return null==t&&(t=null),1==this.length?this.each(function(){return new e(this,t)}):this}}(jQuery)}).call(this);