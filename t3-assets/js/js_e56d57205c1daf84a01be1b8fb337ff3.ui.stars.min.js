!function(e){e.widget("ui.stars",{options:{inputType:"select",split:0,disabled:!1,cancelTitle:"Cancel Rating",cancelValue:0,cancelShow:!1,disableValue:!0,oneVoteOnly:!1,showTitles:!0,captionEl:null,callback:null,cancelClass:"ui-stars-cancel",cancelPlaceholderClass:"ui-stars-cancel-placeholder",starClass:"ui-stars-star",starColor:"orange",starStyle:1,starOnClass:"ui-stars-star-on",starHoverClass:"ui-stars-star-hover",starDisabledClass:"ui-stars-star-disabled",cancelHoverClass:"ui-stars-cancel-hover",cancelDisabledClass:"ui-stars-cancel-disabled"},_create:function(){function s(e,s){if(-1!=e){var i=s?t.starHoverClass:t.starOnClass,n=s?t.starOnClass:t.starHoverClass;l.$stars.eq(e).prevAll("."+t.starClass).andSelf().removeClass(n).addClass(i),l.$stars.eq(e).nextAll("."+t.starClass).removeClass(t.starHoverClass+" "+t.starOnClass),0!=e&&l.$stars.eq(0).hasClass(t.cancelClass)&&l.$stars.eq(0).removeClass([t.starOnClass,t.starHoverClass].join(" ")),l._showCap(t.id2title[e])}else a()}function a(){l.$stars.removeClass(t.starOnClass+" "+t.starHoverClass),l._showCap("")}var l=this,t=this.options,i=0,n=0;this.element.data("former.stars",this.element.html()),t.isSelect="select"==t.inputType,this.$form=e(this.element).closest("form"),this.$selec=t.isSelect?e("select",this.element):null,this.$rboxs=t.isSelect?e("option",this.$selec):e(":radio",this.element),this.$stars=this.$rboxs.map(function(s){var a={value:this.value,title:(t.isSelect?this.text:this.title)||this.value,isDefault:t.isSelect&&this.defaultSelected||this.defaultChecked};if(0==s&&(t.split="number"!=typeof t.split?0:t.split,t.val2id=[],t.id2val=[],t.id2title=[],t.name=t.isSelect?l.$selec.get(0).name:this.name,t.disabled=t.disabled||(t.isSelect?e(l.$selec).attr("disabled"):e(this).attr("disabled"))),a.value==t.cancelValue)return t.cancelTitle=a.title,null;t.val2id[a.value]=i,t.id2val[i]=a.value,t.id2title[i]=a.title,a.isDefault&&(t.checked=i,t.value=t.defaultValue=a.value,t.title=a.title);var c=e("<div/>").addClass("na"==t.id2val[s]?t.cancelClass:t.starClass+" "+t.starColor+" "+t.starStyle),r=e("<a/>").attr("title",t.showTitles?a.title:"").text(a.value),d=e('<div class=" ui-stars-star"><a></a></div>').css({position:"absolute",visibility:"hidden",display:"block"}).appendTo(e("body")),o=d.find("a").width();if(d.remove(),t.split){var u=(i+n)%t.split;if("na"!=t.id2val[s]){var h=Math.floor(o/t.split);c.width(h),r.css("margin-left","-"+u*h+"px")}else n++}return i++,c.append(r).get(0)}),t.items=i,t.isSelect?this.$selec.remove():this.$rboxs.remove(),this.$cancel=e("<div/>").addClass(t.cancelClass).append(e("<a/>").attr("title",t.showTitles?t.cancelTitle:"").text(t.cancelValue)),t.cancelShow&=!t.disabled&&!t.oneVoteOnly,t.cancelShow&&this.element.append(this.$cancel),this.element.append(this.$stars),void 0===t.checked&&(t.checked=-1,t.value=t.defaultValue=t.cancelValue,t.title=""),this.$value=e("<input type='hidden' name='"+t.name+"' value='"+t.value+"' />"),this.element.append(this.$value),0===this.element.find("."+t.cancelClass).length&&this.element.prepend(e("<div/>").addClass(t.cancelPlaceholderClass)),this.$stars.bind("click.stars",function(e){if(!t.forceSelect&&t.disabled)return!1;var a=l.$stars.index(this);t.checked=a,t.value=t.id2val[a],t.title=t.id2title[a],l.$value.attr({disabled:t.disabled?"disabled":"",value:t.value}),t.disabled||l.$value.removeAttr("disabled"),s(a,!1),l._disableCancel(),!t.forceSelect&&l.callback(e,"star")}).bind("mouseover.stars",function(){if(t.disabled)return!1;var e=l.$stars.index(this);s(e,!0)}).bind("mouseout.stars",function(){return t.disabled?!1:void s(l.options.checked,!1)}),this.$cancel.bind("click.stars",function(e){return t.forceSelect||!t.disabled&&t.value!=t.cancelValue?(t.checked=-1,t.value=t.cancelValue,t.title="",l.$value.val(t.value),t.disableValue&&l.$value.attr({disabled:"disabled"}),a(),l._disableCancel(),void(!t.forceSelect&&l.callback(e,"cancel"))):!1}).bind("mouseover.stars",function(){return l._disableCancel()?!1:(l.$cancel.addClass(t.cancelHoverClass),a(),void l._showCap(t.cancelTitle))}).bind("mouseout.stars",function(){return l._disableCancel()?!1:(l.$cancel.removeClass(t.cancelHoverClass),void l.$stars.triggerHandler("mouseout.stars"))}),this.$form.bind("reset.stars",function(){!t.disabled&&l.select(t.defaultValue)}),e(window).unload(function(){l.$cancel.unbind(".stars"),l.$stars.unbind(".stars"),l.$form.unbind(".stars"),l.$selec=l.$rboxs=l.$stars=l.$value=l.$cancel=l.$form=null}),this.select(t.value),t.disabled&&this.disable()},_disableCancel:function(){var e=this.options,s=e.disabled||e.oneVoteOnly||e.value==e.cancelValue;return s?this.$cancel.removeClass(e.cancelHoverClass).addClass(e.cancelDisabledClass):this.$cancel.removeClass(e.cancelDisabledClass),this.$cancel.css("opacity",s?.5:1),s},_disableAll:function(){var e=this.options;this._disableCancel(),e.disabled?this.$stars.filter("div").addClass(e.starDisabledClass):this.$stars.filter("div").removeClass(e.starDisabledClass)},_showCap:function(e){var s=this.options;s.captionEl&&s.captionEl.text(e)},value:function(){return this.options.value},select:function(e){var s=this.options,a=e==s.cancelValue?this.$cancel:this.$stars.eq(s.val2id[e]);s.forceSelect=!0,a.triggerHandler("click.stars"),s.forceSelect=!1},selectID:function(e){var s=this.options,a=-1==e?this.$cancel:this.$stars.eq(e);s.forceSelect=!0,a.triggerHandler("click.stars"),s.forceSelect=!1},enable:function(){this.options.disabled=!1,this._disableAll()},disable:function(){this.options.disabled=!0,this._disableAll()},destroy:function(){return this.$form.unbind(".stars"),this.$cancel.unbind(".stars").remove(),this.$stars.unbind(".stars").remove(),this.$value.remove(),this.element.unbind(".stars").html(this.element.data("former.stars")).removeData("stars"),this},callback:function(e,s){var a=this.options;a.callback&&a.callback(this,s,a.value,e),a.oneVoteOnly&&!a.disabled&&this.disable()}}),e.extend(e.ui.stars,{version:"3.0.1"})}(jQuery);;